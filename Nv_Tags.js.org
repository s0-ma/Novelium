var Nv_Tags = new Object();

/**********Nv_SYS**********/
Nv_Tags.Sys = new Object();

Nv_Tags.Sys.delay = function(time,func){
	setTimeout(func,time);
};

Nv_Tags.Sys.click = function(){
	nv_scripter.go();
};

Nv_Tags.Sys.enable = function(bool){
	nv_scripter.setEnable(bool);
};

Nv_Tags.Sys.jump = function(filename){
	 nv_scripter.init(filename,1);
}

/**********Nv_DISP**********/
Nv_Tags.Disp = new Object();

Nv_Tags.Disp.fadeOut = function(time){
	//$("#container").fadeOut(time);
	$("#scenario_img").fadeOut(time);
};

Nv_Tags.Disp.fadeIn = function(time){
	//$("#container").fadeIn(time);
	$("#scenario_img").fadeIn(time);
};

Nv_Tags.Disp.shake_v = function(dy,time){
	var timer = setInterval(function(){
					$("#layer_scenario_main").animate({ top: -dy }, 75).animate({ top: dy }, 75);
				},150);
	setTimeout(function(){
					clearInterval(timer);
					$("#layer_scenario_main").animate({ top: 0 }, 75);
				},time);
};

Nv_Tags.Disp.shake_h = function(dx,time){
	var timer = setInterval(function(){
					$("#layer_scenario_main").animate({ left: -dx }, 75).animate({left: dx }, 75);
				},150);
	setTimeout(function(){
					clearInterval(timer);
					$("#layer_scenario_main").animate({ left: 0 }, 75);
				},time);
};

/**********SOUND**********/
Nv_Tags.Audio = new Object();

Nv_Tags.Audio.bgm_play = function(path){
	nv_audio.BGM_setPath(path);
	nv_audio.BGM_setVolume(nv_storage.get("global.bgm")/100);
	nv_audio.BGM_play();
};

Nv_Tags.Audio.bgm_stop = function(){
	nv_audio.BGM_stop();
}

/**********BG**********/
Nv_Tags.BG = new Object();

Nv_Tags.BG.color = function(color){
		$("#bg").css("background-image","none");
		$("#scenario_img").css("background-color",color);
}

Nv_Tags.BG.set = function(path){
	var img = new Image();
	img.src = path;
	img.onload = function(){
		$("#bg").remove();
		$("#scenario_img").prepend("<div id=\"bg\" style=\"display:none;background-image:url(\'" + path + "\'); background-size:100% 100%; width:100%; height:100%; top:0;left:0;\"></div>");
		$("#bg").fadeIn("fast");
	}
};

Nv_Tags.Trans = new Object();

Nv_Tags.Trans.out_left = function(){
	$("#scenario_curtain").css("transition","0.5s background-color linear 1s, 1s height linear");
}



/**********Character**********/

var Character = function(path,v,h){
//カットインがある場合バッファ処理したほうが良いかも

	var self = this;

	//public property
	this.path = path;
	this.id = path.replace(/\//g,"").replace(/\./g,"");
	this.img = new Image();
	this.v = v;
	this.h = h;
	this.face = [];

	//constructor
	this.img.src = path;

	//method
	this.show = function(){
		$("#scenario_img").append("<img id=\"" + self.id + "\" src=\""+self.path+"\" style=\"display:none;position:absolute; top:"+this.v+"px; left:"+this.h+"px; \">");
		$("#"+self.id).fadeIn("slow");

	}; 

	this.css = function(tag,val){
		$("#"+self.id).css(tag,val);
	}

	this.hide = function(){
		$("#"+self.id).remove();
	};

	this.addface = function(id,path,v,h){
		this.face[id] = new Array(path,v,h);
	};

	this.showface = function(id){
	        $("#scenario_img").append("<img id=\""+self.id+"_"+id+ "\"" 
		        						+ " src=\""+this.face[id][0]+"\""
		        						+ "style=\"position:absolute; top:"+parseInt(this.v+this.face[id][1])+"px;left:"+parseInt(this.h+this.face[id][2])+"px;\">");
	};

	this.rmface = function(id){
		$("#"+self.id + "_" + id).remove();
	};
};

